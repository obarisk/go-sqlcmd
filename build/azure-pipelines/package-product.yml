# sqlcmd package pipeline

trigger: 
  tags:
    include:
      - v0.*

pr: none

variables:
  VERSION: '0.0.1'
  Build.SourcesCliDirectory: '$(Build.SourcesDirectory)/'

stages:
  - stage: CreatePackages
    displayName: Create and Test Package Matrix
    jobs:
    - job: CreateAndTestPackages
      strategy:
        matrix:
          rpm:
            imageName: 'ubuntu-latest'
            os: linux
            type: rpm
          debian:
            imageName: 'ubuntu-latest'
            os: linux
            type: debian  
          docker:
            imageName: 'ubuntu-latest'
            os: linux
            type: docker
      pool:
        vmImage: $(imageName)
      steps:
        - template: package-create.yml
          parameters:
            OS: $(os)
            Type: $(type)
        - template: package-test.yml
          parameters:
            OS: $(os)
            Type: $(type)
